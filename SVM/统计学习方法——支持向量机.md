---
typora-copy-images-to: image
---

# ç»Ÿè®¡å­¦ä¹ æ–¹æ³•â€”â€”æ”¯æŒå‘é‡æœº

create: 2021/11/23 å¹¿å·ž                                                                                                     updateï¼š2021/11/27 å¹¿å·ž

[toc]

==æ³¨ï¼šæŽèˆªçš„ç»Ÿè®¡å­¦ä¹ æ–¹æ³•ä¸­æœ‰å…³ç¡¬é—´éš”å’Œè½¯é—´éš”æ”¯æŒå‘é‡çš„éƒ¨åˆ†æ²¡å†™ï¼ˆ7.2.3ï¼‰ã€‚==

![image-20211123025445809](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211123025445809.png)

## SVMç®€ä»‹

æ”¯æŒå‘é‡æœºï¼ˆsupport vector machines, SVMï¼‰æ˜¯ä¸€ç§äºŒåˆ†ç±»æ¨¡åž‹ï¼Œå®ƒçš„åŸºæœ¬æ¨¡åž‹æ˜¯å®šä¹‰åœ¨ç‰¹å¾ç©ºé—´ä¸Šçš„**é—´éš”æœ€å¤§çš„çº¿æ€§åˆ†ç±»å™¨**ï¼Œé—´éš”æœ€å¤§ä½¿å®ƒæœ‰åˆ«äºŽæ„ŸçŸ¥æœºï¼›SVMè¿˜åŒ…æ‹¬**æ ¸æŠ€å·§**ï¼Œè¿™ä½¿å®ƒæˆä¸ºå®žè´¨ä¸Šçš„éžçº¿æ€§åˆ†ç±»å™¨ã€‚SVMçš„å­¦ä¹ ç­–ç•¥å°±æ˜¯é—´éš”æœ€å¤§åŒ–ã€‚

**é—´éš”æœ€å¤§åŒ–**ï¼šå¯»æ‰¾ä¸€ä¸ªè¶…å¹³é¢ï¼Œè¿™ä¸ªè¶…å¹³é¢ä½¿å¾—ä¸Žå®ƒè·ç¦»æœ€è¿‘çš„æ ·æœ¬ç‚¹çš„è·ç¦»å¿…é¡»å¤§äºŽå…¶ä»–æ‰€æœ‰è¶…å¹³é¢åˆ’åˆ†ä¸Žæœ€è¿‘çš„æ ·æœ¬ç‚¹çš„è·ç¦»ã€‚

![image-20211114144809583](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211114144809583.png)

![image-20211114144839021](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211114144839021.png)

SVMå¯ä»¥åˆ’åˆ†éžçº¿æ€§å¹³é¢ï¼Œå°†ä½Žç»´ç©ºé—´è½¬æ¢ä¸ºé«˜ç»´ç©ºé—´ï¼Œå†åˆ’åˆ†é«˜ç»´ç©ºé—´ã€‚**åœ¨ä½Žç»´ç©ºé—´ä¸Šçš„éžçº¿æ€§åˆ’åˆ†çš„æ•°æ®åœ¨æŸä¸€é«˜ç»´åº¦ä¸Šä¸€å®šæ˜¯çº¿æ€§å¯åˆ†çš„**ã€‚

![image-20211123031153505](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211123031153505.png)

### å‡½æ•°é—´éš”

å‡½æ•°é—´éš”é€šå¸¸è¡¨ç¤ºä¸º:$|w \cdot x_1+b|$

å…¶ä¸­$w$å’Œ$x_1$éƒ½æ˜¯nç»´çš„å‘é‡ï¼Œ$x_1$ä¸ºç¬¬ä¸€ç»„æ ·æœ¬çš„æ•°æ®å‘é‡ï¼Œè¿™ä¸ªå¼å­è¡¨ç¤ºçš„å°±æ˜¯$x_1$è¿™ä¸ªæ•°æ®ç‚¹åˆ°è¶…å¹³é¢$w \cdot x+b=0$çš„è·ç¦»ã€‚ä½†æ˜¯å‡½æ•°é—´éš”ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œè®¡ç®—æœºåœ¨ä¼˜åŒ–çš„æ—¶å€™ï¼Œä¼šåŒæ—¶ç¼©å°$w$å’Œ$b$çš„å€¼æ¥å‡å°$|w \cdot x_1+b|$

å‡è®¾ $|w \cdot x_1+b|=1000$ï¼Œå¦‚æžœåŽ»ä¼˜åŒ–è¿™ä¸ªå¼å­ï¼Œè®¡ç®—æœºå¾ˆæœ‰å¯èƒ½åŒæ—¶ç¼©å°$w$å’Œ$b$å˜æˆ $|\frac{1}{1000}w\cdot x_1+\frac{1}{1000}b|=1$ï¼Œä½†æ˜¯è¿™æ ·è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œ**å› ä¸ºwçš„å€¼æœ¬è´¨ä¸Šæ˜¯æ²¡æœ‰å˜åŒ–çš„åªæ˜¯ç­‰æ¯”ä¾‹ç¼©å°äº†**ã€‚æ‰€ä»¥å°±éœ€è¦å‡ ä½•é—´éš”ã€‚

### å‡ ä½•é—´éš”

å‡ ä½•é—´éš”é€šå¸¸è¡¨ç¤ºä¸º:$\frac {1}{||w||}|w \cdot x_1+b|$

å°±æ˜¯åœ¨å‡½æ•°é—´éš”ä¸­åŠ å…¥äº†$w$çš„$L_2$èŒƒæ•°

$L_2$èŒƒæ•°å®šä¹‰ä¸º$||w||_2 = \sqrt{\sum^N_{i=1}w^2_i}$

å› æ­¤å½“å‡ºçŽ°$w$å’Œ$b$åŒæ—¶ç¼©å°1000å€çš„æƒ…å†µæ—¶ï¼Œ

$\frac{1}{||w||}|\frac{1}{1000}w\cdot x_1+\frac{1}{1000}b|$ï¼Œ å…¶ä¸­$||w||$ä¸º$\frac{1}{1000}\sqrt{\sum^N_{i=1}w^2_i}$ï¼Œå–ä¸ªå€’æ•°å°±èƒ½å°†å…¬å¼é‡Œé¢çš„$\frac{1}{1000}$åŒ–æŽ‰ã€‚

ç»“æžœå˜ä¸º$\frac{1}{\sqrt{\sum^N_{i=1}w^2_i}}|w\cdot x_1+b|$ã€‚æ­¤æ—¶wå‘é‡çš„å€¼å°±èƒ½è¢«ä¼˜åŒ–äº†ã€‚



## çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºä¸Žç¡¬é—´éš”æœ€å¤§åŒ–

å®šä¹‰ä¸€ä¸ªç‰¹å¾ç©ºé—´ä¸Šçš„è®­ç»ƒæ•°æ®é›†:
$$
T=\{(x_1,y_1),(x_2,y_2),â€¦,(x_n,y_n) \}
$$
å…¶ä¸­$x_i \in \chi=R^n$ï¼Œ$y_i \in \mathcal Y=\{+1,-1\}$ï¼Œ$i=1,2,â€¦,N$ï¼Œå…¶ä¸­$x_i$ä¸ºç¬¬iä¸ªå‘é‡ç‰¹å¾ä¹Ÿå°±æ˜¯å®žä¾‹ï¼Œ$y_i$æ˜¯$x_i$çš„ç±»æ ‡è®°ï¼Œå½“$y_i=+1$æ—¶ï¼Œç§°$x_i$ä¸ºæ­£ä¾‹ï¼›å½“$y_i=-1$æ—¶ï¼Œç§°$x_i$ä¸ºè´Ÿä¾‹ï¼Œ$(x_i,y_i)$ç§°ä¸ºæ ·æœ¬ç‚¹ã€‚

åœ¨SVMä¸­å¯¹äºŽç»™å®šçš„è®­ç»ƒæ•°æ®é›†$T$å’Œè¶…å¹³é¢$(w,b)$ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰è¶…å¹³é¢$(w,b)$å…³äºŽæ ·æœ¬ç‚¹$(x_i,y_i)$çš„**å‡½æ•°é—´éš”**ï¼š
$$
\tilde{\gamma}_i=y_i(w \cdot x_i+b)
$$
å®šä¹‰è¶…å¹³é¢$(w,b)$å…³äºŽè®­ç»ƒæ•°æ®é›†$T$æ‰€æœ‰æ ·æœ¬ç‚¹çš„å‡½æ•°é—´éš”çš„æœ€å°å€¼ä¸ºï¼š
$$
\tilde{\gamma}=\min_{i=1,â€¦,N}\tilde{\gamma}_i
$$
å®šä¹‰å‡ ä½•é—´éš”$\gamma_i$ä¸ºï¼š
$$
\gamma_i=y_i\left(\frac{w}{||w||}\cdot x_i+\frac{b}{||w||}\right)
$$
å®šä¹‰è¶…å¹³é¢$(w,b)$å…³äºŽè®­ç»ƒæ•°æ®é›†$T$æ‰€æœ‰æ ·æœ¬ç‚¹çš„å‡ ä½•é—´éš”çš„æœ€å°å€¼ä¸ºï¼š
$$
\gamma=\min_{i=1,â€¦,N}\gamma_i
$$
å› æ­¤å¾ˆå®¹æ˜“å¯ä»¥å¾—å‡ºå‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”çš„å…³ç³»ï¼š
$$
\gamma_i=\frac{\tilde{\gamma}_i}{||w||} \\
\gamma=\frac{\tilde{\gamma}}{||w||}
$$
å¦‚æžœ$||w||=1$é‚£ä¹ˆå‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”æ˜¯ç›¸ç­‰çš„ã€‚

### é—´éš”æœ€å¤§åŒ–

å¯¹äºŽçº¿æ€§å¯åˆ†çš„æ•°æ®è€Œè¨€ï¼Œæ”¯æŒå‘é‡æœºå¸Œæœ›æ‰¾åˆ°èƒ½å¤Ÿæ­£ç¡®åˆ’åˆ†æ•°æ®é›†å¹¶ä¸”å‡ ä½•é—´éš”æœ€å¤§çš„åˆ†ç¦»è¶…å¹³é¢ï¼Œçº¿æ€§å¯åˆ†çš„è¶…å¹³é¢æœ‰æ— ç©·å¤šä¸ªï¼Œä½†æ˜¯å‡ ä½•é—´éš”æœ€å¤§çš„åˆ†ç¦»è¶…å¹³é¢æ˜¯å”¯ä¸€çš„ã€‚

æœ€å¤§é—´éš”åˆ†ç¦»è¶…å¹³é¢å¯ä»¥è½¬æ¢ä¸ºä¸‹é¢çš„çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ï¼š
$$
\max_{w,b}  \qquad \gamma \\
s.t. \qquad y_i\left(\frac{w}{||w||}\cdot x_i+\frac{b}{||w||}\right)â‰¥\gamma, \quad i=1,2,...,N
$$
æœ€å¤§åŒ–è¶…å¹³é¢$(w,b)$å…³äºŽè®­ç»ƒæ•°æ®é›†çš„å‡ ä½•é—´éš”$\gamma$

æ ¹æ®å‡ ä½•é—´éš”çš„å‡½æ•°é—´éš”çš„å…³ç³»ï¼Œå¯ä»¥å°†ä¸Šå¼å†™ä¸ºï¼š
$$
\max_{w,b}  \qquad \frac{\tilde{\gamma}}{||w||} \\
s.t. \qquad y_i\left(w\cdot x_i+b\right)â‰¥\tilde\gamma, \quad i=1,2,...,N
$$
åœ¨ä¸Šé¢å¯¹äºŽå‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”çš„ä»‹ç»ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå°†$w$å’Œ$b$åŒæ—¶æŒ‰æ¯”ä¾‹æ”¾å¤§æˆ–è€…ç¼©å°ï¼Œå‡½æ•°é—´éš”$\tilde{\gamma}$ä¹Ÿä¼šæŒ‰ç…§åŒæ ·çš„æ¯”ä¾‹å˜åŒ–ï¼Œå› ä¸ºå‡½æ•°é—´éš”å¯¹äºŽä¼˜åŒ–é—®é¢˜çš„ä¸ç­‰å¼çº¦æŸæ²¡æœ‰å½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å–$\tilde{\gamma}=1$ï¼Œå¸¦å…¥ä¸Šé¢çš„å¼å­å°±å¯ä»¥å¾—åˆ°ï¼š
$$
\min_{w,b}  \qquad \frac{1}{2}||w||^2 \\
s.t. \qquad y_i\left(w\cdot x_i+b\right)-1â‰¥0, \quad i=1,2,...,N
$$
æœ€å¤§åŒ–$\frac{1}{||w||}$å’Œæœ€å°åŒ–$\frac{1}{2}||w||^2$æ˜¯ç­‰ä»·çš„ï¼ŒåŠ å…¥1\2å’Œ2æ¬¡æ–¹æ˜¯æ–¹ä¾¿ä¸‹é¢è®¡ç®—ä¸­æ±‚å¯¼æ•°ã€‚

åˆ°æ­¤å°±å½¢æˆäº†ä¸€ä¸ªå®Œæ•´çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š

![image-20211125103505267](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211125103505267.png)

### å­¦ä¹ çš„å¯¹å¶ç®—æ³•

ä¸ºäº†æ±‚è§£çº¦æŸé—®é¢˜ï¼Œæˆ‘ä»¬æž„å»ºæ‹‰æ ¼æœ—æ—¥ä¹˜æ•°å¦‚ä¸‹ï¼š
$$
L(w,b,\alpha)=\frac{1}{2}||w||^2+\sum_{i=1}^n\alpha_{i}(1-y_if(x_i)) \\=\frac{1}{2}||w||^2+\sum_{i=1}^n\alpha{_i}(1-y_i(w\cdot x_i+b))
$$
$\alpha=(\alpha_1,\alpha_2,...,\alpha_N)^T$ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­å‘é‡ã€‚

==è¯¥éƒ¨åˆ†æœ‰3ç‚¹éœ€è¦è¡¥å……1.å…³äºŽ$\alpha_i \ge0$çš„è¯´æ˜Žã€‚2.æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§çš„è¯´æ˜Žã€‚3.KKTæ¡ä»¶çš„è¯´æ˜Žã€‚==

æ ¹æ®æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§ï¼Œå¯ä»¥è½¬æ¢æˆæžå¤§æžå°é—®é¢˜ï¼ˆè¿™é‡Œä¸ç»†è¯´äº†ï¼ŒReferenceä¸­ç»™å‡ºçš„é“¾æŽ¥æœ‰è¯¦ç»†çš„è§£é‡Šï¼‰
$$
\max_{\alpha}\min_{w,b}L(w,b,\alpha)
$$
æˆ‘ä»¬éœ€è¦æ±‚Lå¯¹$w,b$çš„æžå°å€¼ï¼Œå†æ±‚å¯¹$\alpha$çš„æžå¤§å€¼ã€‚

- æ±‚$\min_{w,b}L(w,b,\alpha)$

  å¯¹wå’Œbæ±‚åå¯¼ï¼š
  $$
  \frac{\partial L(w,b,\alpha)}{\partial w}=w-\sum_{i=1}^N\alpha_{i}y_ix_i=0 \\
   \frac{\partial L(w,b,\alpha)}{\partial b}=-\sum_{i=1}^N\alpha_{i}y_i=0
  $$
  å¾—ï¼š
  $$
  w=\sum_{i=1}^N\alpha_{i}y_ix_i \\
   \sum_{i=1}^N\alpha_{i}y_i=0
  $$
  å°†ç»“æžœå¸¦å…¥æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼Œå¾—åˆ°ç»“æžœï¼š
  $$
  L(w,b,\alpha)=\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{i}y_i\alpha_{j}y_j(x_i\cdot x_j)+\sum_{i=1}^N\alpha_{i}-\sum_{i=1}^N\alpha_{i}y_i((\sum_{j=1}^N\alpha_{j}y_jx_j)\cdot x_i+b) \\=-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{_i}y_i\alpha_{j}y_j(x_i\cdot x_j)+\sum_{i=1}^N\alpha_{_i}
  $$
  å› æ­¤å¾—åˆ°äº†:
  $$
  \min_{w,b} L(w,b,\alpha)=-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{_i}y_i\alpha_{j}y_j(x_i\cdot x_j)+\sum_{i=1}^N\alpha_{_i}
  $$
  
- æ±‚$\min_{w,b}L(w,b,\alpha)$å¯¹$\alpha$çš„æžå¤§ï¼Œæ˜¯å¯¹å¶é—®é¢˜

$$
\max_{\alpha}-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{i}y_i\alpha_{j}y_j(x_i\cdot x_j)+\sum_{i=1}^N\alpha_{i} \\s.t.\quad \sum_{i=1}^N\alpha_{i}y_i=0 \\ \alpha_i\ge 0, i=1,2,...,n
$$

ç­‰ä»·äºŽ
$$
\min_{\alpha} \quad\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{i}y_i\alpha_{j}y_j(x_i\cdot x_j)-\sum_{i=1}^N\alpha_{i} \\s.t.\quad \sum_{i=1}^N\alpha_{i}y_i=0 \\ \alpha_i\ge 0, i=1,2,...,n
$$
å› ä¸ºåŽŸå§‹é—®é¢˜æ»¡è¶³Slateræ¡ä»¶ï¼Œæ‰€ä»¥å­˜åœ¨$w^*$,$\alpha^*$,$\beta^*$ ï¼Œä½¿$w^*$æ˜¯åŽŸå§‹é—®é¢˜çš„è§£ï¼Œ$\alpha^*$,$\beta^*$æ˜¯å¯¹å¶é—®é¢˜çš„è§£ã€‚æ‰€ä»¥æ±‚è§£åŽŸå§‹é—®é¢˜å¯ä»¥è½¬æ¢ä¸ºæ±‚è§£å¯¹å¶é—®é¢˜ã€‚

ç®—æ³•æµç¨‹å¦‚ä¸‹:

![image-20211125145248489](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211125145248489.png)

## çº¿æ€§æ”¯æŒå‘é‡æœºä¸Žè½¯é—´éš”æœ€å¤§åŒ–



æœ‰æ—¶å€™æœ¬æ¥æ•°æ®çš„ç¡®æ˜¯å¯åˆ†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç”¨çº¿æ€§åˆ†ç±»SVMçš„å­¦ä¹ æ–¹æ³•æ¥æ±‚è§£ï¼Œä½†æ˜¯å´å› ä¸ºæ··å…¥äº†å¼‚å¸¸ç‚¹ï¼Œå¯¼è‡´ä¸èƒ½çº¿æ€§å¯åˆ†ï¼Œæ¯”å¦‚ä¸‹å›¾ï¼Œåœ¨ðŸ”ºä¸­å­˜åœ¨åœ†å½¢çš„çš„å¼‚å¸¸ç‚¹ï¼Œå› æ­¤æ— æ³•æŒ‰ç…§ä¸Šé¢è®²çš„çº¿æ€§å¯åˆ†çš„æ–¹æ³•è¿›è¡Œåˆ†ç±»ï¼Œå› æ­¤SVMå¼•å…¥äº†è½¯é—´éš”æœ€å¤§åŒ–ï¼Œè¿™**å±žäºŽçº¿æ€§ä¸å¯åˆ†**ã€‚

![image-20211125154520166](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211125154520166.png)

### è½¯é—´éš”æœ€å¤§åŒ–

çº¿æ€§ä¸å¯åˆ†æ„å‘³ç€æŸäº›æ ·æœ¬ç‚¹ä¸èƒ½æ»¡è¶³å‡½æ•°é—´éš”å¤§äºŽç­‰äºŽ1çš„çº¦æŸæ¡ä»¶ã€‚ä¸ºæ­¤ï¼Œå¯¹æ¯ä¸€ä¸ªæ ·æœ¬ç‚¹å¼•è¿›ä¸€ä¸ªæ¾å¼›å˜é‡$\xi_i\ge 0$ï¼Œä½¿å¾—å‡½æ•°é—´éš”åŠ ä¸Šæ¾å¼›å˜é‡å¤§äºŽç­‰äºŽ1ï¼Œå› æ­¤çº¦æŸæ¡ä»¶å°±å˜ä¸ºäº†ï¼š
$$
y_i(w\cdot x_i+b)\ge 1-\xi_i,i=1,2,...,n 
$$
å› ä¸ºåŠ å…¥äº†æ¾å¼›å˜é‡ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å‡½æ•°ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼š
$$
 \frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i
$$
è¿™é‡ŒC>0ä¸ºæƒ©ç½šå‚æ•°ï¼Œå€¼è¶Šå¤§å¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šè¶Šå¤§ï¼Œè¶Šå®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆã€‚

çº¿æ€§ä¸å¯åˆ†çš„çº¿æ€§æ”¯æŒå‘é‡æœºé—®é¢˜å˜æˆäº†å¦‚ä¸‹çš„å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼ˆåŽŸå§‹é—®é¢˜ï¼‰ï¼š
$$
\min_{w,b,\xi} \quad \frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i \\
s.t.\quad y_i(w\cdot x_i+b)\ge1-\xi_i,i=1,2,...,N \\
\xi_i\ge 0,i=1,2,...,N
$$

### è½¯é—´éš”æœ€å¤§åŒ–çš„å¯¹å¶ç®—æ³•

è¯¥é—®é¢˜çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸º:
$$
L(w,b,\xi,\alpha,\mu)=\frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i-\sum_{i=1}^N\alpha_i(y_i(w\cdot x_i+b)-1+\xi_i)-\sum_{i=1}^N\mu_i\xi_i\\
\alpha_i\ge 0,\mu_i\ge 0,i=1,2,...,n
$$
åŽŸé—®é¢˜å°±å˜ä¸ºäº†ï¼š
$$
 \min_{w,b,\xi} \max_{\alpha,\mu}L(w,b,\xi,\alpha,\mu)
$$
å¯¹å¶é—®é¢˜ä¸ºï¼š
$$
 \max_{\alpha,\mu}\min_{w,b,\xi} L(w,b,\xi,\alpha,\mu)
$$
 ä¸ºäº†æ±‚è§£å¯¹å¶é—®é¢˜ï¼Œéœ€è¦å…ˆæ±‚$L(w,b,\xi,\alpha,\mu)$å¯¹äºŽ$w,b,\xi$çš„æžå°ï¼Œå†æ±‚å¯¹$\alpha,\mu$çš„æžå¤§ã€‚
$$
\frac{\partial L(w,b,\xi,\alpha,\mu)}{\partial w}=w-\sum_{i=1}^N\alpha_{i}y_ix_i=0 \\\frac{\partial L(w,b,\xi,\alpha,\mu)}{\partial b}=-\sum_{i=1}^N\alpha_{i}y_i=0 \\
\frac{\partial L(w,b,\xi,\alpha,\mu)}{\partial \xi_i}=C-\alpha_i-\mu_i=0
$$
å¾—:
$$
w=\sum_{i=1}^N\alpha_{i}y_ix_i \\
 \sum_{i=1}^N\alpha_{i}y_i=0 \\
 C-\alpha_i-\mu_i=0
$$
*ä»£å›žåˆ°$L(w,b,\xi,\alpha,\mu)$çš„è¡¨è¾¾å¼å¾—ï¼š*
$$
L(w,b,\xi,\alpha,\mu)=-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{i}y_i\alpha_{j}y_j(x_i\cdot x_j)+\sum_{i=1}^N\alpha_{i}
$$
**æ±‚$L(w,b,\xi,\alpha,\mu)$å¯¹äºŽ$\alpha,\mu$çš„æžå¤§ï¼Œå³ï¼š**
$$
\max \quad-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{i}y_i\alpha_{j}y_j(x_i\cdot x_j)+\sum_{i=1}^N\alpha_{i} \\
 s.t.\quad \sum_{i=1}^N\alpha_{i}y_i=0 \\
 C-\alpha_i-\mu_i=0 \\
 \alpha_i\ge 0 \\
 \mu_i\ge 0,i=1,2,...,N
$$
åˆ©ç”¨$C-\alpha_i-\mu_i=0$æ¶ˆåŽ»çº¦æŸæ¡ä»¶ä¸­çš„$\mu$å¹¶å°†æžå¤§é—®é¢˜è½¬åŒ–ä¸ºæžå°é—®é¢˜ï¼š
$$
\max \quad-\frac{1}{2}\sum_{i=1}^N\sum_{j=1}^N\alpha_{i}y_i\alpha_{j}y_j(x_i\cdot x_j)+\sum_{i=1}^N\alpha_{i} \\
 s.t.\quad \sum_{i=1}^N\alpha_{i}y_i=0 \\
0â‰¤\alpha_i â‰¤C, i=1,2,...,N
$$
æ•´ä¸ªç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š

![image-20211125164308338](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211125164308338.png)

### åˆé¡µæŸå¤±å‡½æ•°

ä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œå­¦ä¹ ç®—æ³•éƒ½æ˜¯å‡¸äºŒæ¬¡è§„åˆ’ï¼ŒSVMè¿˜æœ‰å¦å¤–ä¸€ç§è§£é‡Šï¼Œå°±æ˜¯æœ€å°åŒ–ä»¥ä¸‹çš„ç›®æ ‡å‡½æ•°ï¼š
$$
\sum_{i=1}^N[1-y_i(w\cdot x_i+b)]_+ + \lambda||w||^2
$$
ç¬¬ä¸€é¡¹å‡½æ•°å°±è¢«ç§°ä¸ºåˆé¡µæŸå¤±å‡½æ•°ï¼Œç¬¬äºŒé¡¹æ˜¯æ­£åˆ™åŒ–é¡¹ã€‚å…¶ä¸­ä¸‹æ ‡"+"è¡¨ç¤ºå–æ­£å€¼çš„å‡½æ•°ï¼š
$$
[z]_+=\begin{cases}
 z & z ï¼ž 0 \\
0 &  z â‰¤ 0 \\
\end{cases}
$$

ä¸Šé¢çš„å‡½æ•°å…¶å®žå°±æ˜¯maxå‡½æ•°

$$\max(0,1-y_i(w\cdot x_i+b))=\xi_i$$

é‚£ä¹ˆæŸå¤±å‡½æ•°å¾ˆå¥½ç†è§£äº†ï¼Œå½“æ ·æœ¬ç‚¹è¢«æ­£ç¡®åˆ†ç±»ï¼Œå¹¶ä¸”å‡½æ•°é—´éš”$y_i(w\cdot x_i+b)$å¤§äºŽ1æ—¶ï¼ŒæŸå¤±æ˜¯0ã€‚å¦åˆ™æŸå¤±ä¸º$1-y_i(w\cdot x_i+b)$ï¼Œå“ªæ€•è¢«æ­£ç¡®åˆ†ç±»ä½†æ˜¯å‡½æ•°é—´éš”å°äºŽ1ä¹Ÿä¼šæœ‰æŸå¤±ã€‚

åŽŸå§‹æœ€ä¼˜åŒ–é—®é¢˜ä¸ºï¼š
$$
\min_{w,b,\xi} \quad \frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i \\
s.t.\quad y_i(w\cdot x_i+b)\ge1-\xi_i,i=1,2,...,N \\
\xi_i\ge 0,i=1,2,...,N
$$
ç­‰ä»·äºŽæœ€ä¼˜åŒ–é—®é¢˜:
$$
\min_{w,b} \quad\sum_{i=1}^N[1-y_i(w\cdot x_i+b)]_+ + \lambda||w||^2
$$
ä»¤$1-y_i(w\cdot x_i +b)=\xi_i$ï¼Œåˆ™$\xi_i\ge0$ã€‚å½“$1-y_i(w\cdot x_i +b)ï¼ž0$æ—¶ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°é—´éš”æ¯”1å°ï¼Œé‚£ä¹ˆæŸå¤±å°±æ˜¯$1-y_i(w\cdot x_i +b)$ä¹Ÿå°±æ˜¯$\xi_i$ã€‚å¦‚æžœå‡½æ•°é—´éš”æ¯”1å¤§ï¼Œ$\xi_i=0$åŒæ—¶æŸå¤±ä¹Ÿæ˜¯0ï¼Œæ‰€ä»¥æŸå¤±æ°¸è¿œå’Œ$\xi_i$ä¿æŒä¸€è‡´ã€‚

å³ï¼š
$$
\sum_{i=1}^N[1-y_i(w\cdot x_i+b)]_+=[\xi_i]_+=\xi_i
$$
æ‰€ä»¥æœ€ä¼˜åŒ–é—®é¢˜å°±å¯ä»¥å†™æˆ:
$$
\min_{w,b}\lambda||w||^2+\sum_{i=1}^N\xi_i
$$
å–$\lambda=\frac{1}{2C}$ï¼Œåˆ™ï¼š
$$
\min_{w,b} \frac{1}{C}(\frac{1}{2}||w||^2+C\sum_{i=1}^N\xi_i)
$$
è¯¥ç»“æžœä¸ŽåŽŸå§‹æœ€ä¼˜åŒ–é—®é¢˜çš„å…¬å¼ä¸€æ ·ï¼Œæ‰€ä»¥åŽŸå§‹çš„å…¬å¼å¾—åˆ°äº†è¯æ˜Žã€‚

ä¸‹å›¾æ˜¯åˆé¡µæŸå¤±å‡½æ•°çš„å›¾

![image-20211125184957980](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211125184957980.png)

## éžçº¿æ€§æ”¯æŒå‘é‡æœºä¸Žæ ¸å‡½æ•°

### æ ¸æŠ€å·§

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä¸€äº›æ•°æ®åœ¨ä¸€ä¸ªç©ºé—´æ˜¯çº¿æ€§ä¸å¯åˆ†çš„ï¼Œæˆ‘ä»¬å°†å®ƒæŠ•å½±åˆ°å¦ä¸€ä¸ªç©ºé—´å°±å¯ä»¥åˆ†å‰²äº†ã€‚

çº¿æ€§åˆ†ç±»æ–¹æ³•æ±‚è§£éžçº¿æ€§é—®é¢˜åˆ†ä¸ºä¸¤æ­¥ï¼šé¦–å…ˆæ˜¯ä½¿ç”¨ä¸€ä¸ªå˜æ¢å°†åŽŸç©ºé—´çš„æ•°æ®æ˜ å°„åˆ°æ–°ç©ºé—´ï¼›ç„¶åŽåœ¨æ–°ç©ºé—´é‡Œç”¨çº¿æ€§åˆ†ç±»å­¦ä¹ æ–¹æ³•ä»Žè®­ç»ƒæ•°æ®ä¸­å­¦ä¹ æ¨¡åž‹ï¼Œæ ¸æŠ€å·§å°±æ˜¯è¿™æ ·çš„æ–¹æ³•ã€‚

![image-20211125213343914](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211125213343914.png)



è®¾$\chi$æ˜¯è¾“å…¥ç©ºé—´ï¼ˆæ¬§æ°ç©ºé—´$\mathbb{R}^n$çš„å­é›†æˆ–ç¦»æ•£é›†åˆï¼‰ï¼Œåˆè®¾$\mathcal H$ä¸ºç‰¹å¾ç©ºé—´ï¼ˆå¸Œå°”ä¼¯ç‰¹ç©ºé—´ï¼‰ï¼Œå¦‚æžœå­˜åœ¨ä¸€ä¸ªä»Ž$\chi$åˆ°$\mathcal H$çš„æ˜ å°„ï¼š
$$
\phi(x):\chi\rightarrow \mathcal H
$$
ä½¿å¾—å¯¹æ‰€æœ‰çš„$x,z\in \chi$ï¼Œå‡½æ•°$K(x,z)$æ»¡è¶³æ¡ä»¶:
$$
K(x,z)=\phi(x)\cdot \phi(z)
$$
åˆ™ç§°$K(x,z)$ä¸ºæ ¸å‡½æ•°ï¼Œ$\phi(x)$ä¸ºæ˜ å°„å‡½æ•°ï¼Œ$\phi(x)\cdot \phi(z)$æ˜¯è¿™ä¸¤ä¸ªå‘é‡çš„å†…ç§¯ã€‚

æ ¸æŠ€å·§çš„æƒ³æ³•æ˜¯ï¼šåœ¨å­¦ä¹ å’Œé¢„æµ‹ä¸­åªå®šä¹‰æ ¸å‡½æ•°$K(x,z)$è€Œä¸æ˜¾å¼å®šä¹‰æ˜ å°„å‡½æ•°$\phi(x)$ã€‚å¯¹äºŽç»™å®šçš„æ ¸å‡½æ•°ï¼Œæ˜ å°„å‡½æ•°å¹¶ä¸å”¯ä¸€ã€‚

**æˆ‘ä»¬å¦‚æžœç›´æŽ¥è®¡ç®—$K(w,z)$æ¯”è¾ƒå®¹æ˜“ï¼Œä½†æ˜¯æ±‚$\phi(x)\cdot \phi(z)$çš„ç»“æžœæ¥è®¡ç®—Kå°±å¾ˆå¤æ‚äº†ã€‚**

æˆ‘ä»¬æ³¨æ„åˆ°åœ¨çº¿æ€§æ”¯æŒå‘é‡æœºçš„å¯¹å¶é—®é¢˜ä¸­ï¼Œæ— è®ºæ˜¯ç›®æ ‡å‡½æ•°è¿˜æ˜¯å†³ç­–å‡½æ•°éƒ½åªæ¶‰åŠè¾“å…¥å®žä¾‹å’Œå®žä¾‹ä¹‹é—´çš„å†…ç§¯ï¼Œä½¿ç”¨æ ¸å‡½æ•°æ›¿ä»£å†…ç§¯ï¼Œæ­¤æ—¶å¯¹å¶é—®é¢˜å˜ä¸ºï¼š
$$
W(\alpha)=\frac{1}{2} \sum_{i=1}^{N} \sum_{j=1}^{N} \alpha_{i} \alpha_{j} y_{i} y_{j} K\left(x_{i}, x_{j}\right)-\sum_{i=1}^{N} \alpha_{i}
$$
åˆ†ç±»çš„å†³ç­–å‡½æ•°å˜æˆäº†ï¼š
$$
f(x)=\operatorname{sign}\left(\sum_{i=1}^{N_{s}} a_{i}^{*} y_{i} \phi\left(x_{i}\right) \cdot \phi(x)+b^{*}\right)=\operatorname{sign}\left(\sum_{i=1}^{N_{s}} a_{i}^{*} y_{i} K\left(x_{i}, x\right)+b^{*}\right)
$$
è¿™ç­‰ä»·äºŽç»è¿‡æ˜ å°„å‡½æ•°$\phi(x)$å°†åŽŸæ¥çš„è¾“å…¥ç©ºé—´å˜æ¢åˆ°ä¸€ä¸ªæ–°çš„ç‰¹å¾ç©ºé—´ï¼Œåœ¨æ–°çš„ç‰¹å¾ç©ºé—´é‡Œä»Žè®­ç»ƒæ ·æœ¬ä¸­å­¦ä¹ çº¿æ€§æ”¯æŒå‘é‡æœºã€‚å½“æ˜ å°„å‡½æ•°æ˜¯éžçº¿æ€§å‡½æ•°æ—¶ï¼Œå­¦ä¹ åˆ°çš„å«æœ‰æ ¸å‡½æ•°çš„æ”¯æŒå‘é‡æœºä¸ºéžçº¿æ€§æ”¯æŒå‘é‡æœºã€‚å­¦ä¹ æ˜¯éšå¼åœ°åœ¨ç‰¹å¾ç©ºé—´ä¸­è¿›è¡Œçš„ï¼Œä¸éœ€è¦æ˜¾ç¤ºåœ°å®šä¹‰ç‰¹å¾ç©ºé—´å’Œæ˜ å°„å‡½æ•°ã€‚**è¿™ç§æŠ€å·§ç§°ä¸ºæ ¸æŠ€å·§**ã€‚

åœ¨å®žé™…åº”ç”¨ä¸­ï¼Œå¾€å¾€ä¾èµ–äºŽé¢†åŸŸçŸ¥è¯†ç›´æŽ¥é€‰æ‹©æ ¸å‡½æ•°ï¼Œæ ¸å‡½æ•°é€‰æ‹©çš„æœ‰æ•ˆæ€§éœ€è¦é€šè¿‡å®žéªŒéªŒè¯ã€‚

é€šå¸¸æ‰€è¯´çš„æ ¸å‡½æ•°å°±æ˜¯**æ­£å®šæ ¸**ï¼Œæ­£å®šæ ¸å­˜åœ¨ä»¥ä¸‹å……è¦æ¡ä»¶ï¼š

è®¾$K:\chi * \chi \rightarrow \mathbb{R}$æ˜¯å¯¹ç§°å‡½æ•°ï¼Œåˆ™$K(x,z)$ä¸ºæ­£å®šæ ¸å‡½æ•°çš„å……è¦æ¡ä»¶æ˜¯å¯¹ä»»æ„$x_i\in \chi,i=1,2,...,m$ï¼Œ$K(x,z)$å¯¹åº”çš„GramçŸ©é˜µï¼š
$$
 K=[K(x_i,x_j)]_{m*m}
$$
æ˜¯**åŠæ­£å®šçŸ©é˜µ**ï¼Œåˆ™ç§°$K(x,z)$æ˜¯æ­£å®šæ ¸

### å¸¸ç”¨æ ¸å‡½æ•°

ä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨æ ¸å‡½æ•°ï¼š

- çº¿æ€§æ ¸ 
  $$
  K(x,z)=x^Tz 
  $$
  
- å¤šé¡¹å¼æ ¸ 
  $$
   K(x,z)=(x^Tz+1)^p 
  $$
  
- é«˜æ–¯æ ¸
  $$
  K(x,z)=e^{-\frac{||x-z||^2}{2\sigma^2}}
  $$
   å¦‚æžœå¯¹åº”çš„æ”¯æŒå‘é‡æœºæ˜¯é«˜æ–¯å¾„å‘åŸºå‡½æ•°åˆ†ç±»å™¨ï¼Œé‚£ä¹ˆåˆ†ç±»å†³ç­–å‡½æ•°å°±å˜æˆäº†ï¼š
  $$
  f(x)=\operatorname{sign}\left(\sum_{i=1}^{N_{s}} a_{i}^{*} y_{i} \exp \left(-\frac{\|x-z\|^{2}}{2 \sigma^{2}}\right)+b^{*}\right)
  $$
  å› æ­¤ï¼Œæ•´ä¸ªéžçº¿æ€§æ”¯æŒå‘é‡æœºçš„ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š

  ![image-20211126123537524](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\image-20211126123537524.png)



## åºåˆ—æœ€å°æœ€ä¼˜åŒ–ç®—æ³•

ä»Žä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æ”¯æŒå‘é‡æœºå°†é—®é¢˜è½¬æ¢ä¸ºå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜å…·æœ‰å…¨å±€æœ€ä¼˜è§£å¹¶ä¸”å¾ˆå¤šä¼˜åŒ–ç®—æ³•éƒ½å¯ä»¥æ±‚è§£ï¼Œç„¶è€Œå½“è®­ç»ƒæ ·æœ¬çš„å®¹é‡å¾ˆå¤§æ—¶ï¼Œè¿™äº›ç®—æ³•æ•ˆçŽ‡æžä½Žï¼Œæ‰€ä»¥å°±éœ€è¦SMOç®—æ³•ã€‚

SMOç®—æ³•è¦æ±‚è§£å¦‚ä¸‹çš„å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼š
$$
\min_{\alpha} \quad \frac{1}{2} \sum_{i=1}^{N} \sum_{j=1}^{N} \alpha_{i} \alpha_{j} y_{i} y_{j} K\left(x_{i}, x_{j}\right)-\sum_{i=1}^{N} \alpha_{i} \\
\text { s.t. } \sum_{i=1}^{N} \alpha_{i} y_{i}=0 \\
0 \leq \alpha_{i} \leq C, \quad i=1,2, \cdots, N
$$
åœ¨è¯¥é—®é¢˜ä¸­å˜é‡å°±å˜æˆäº†æ‹‰æ ¼æœ—æ—¥ä¹˜å­$\alpha_i$ã€‚

SMOç®—æ³•æ˜¯ä¸€ç§å¯å‘å¼ç®—æ³•ï¼Œå…¶è§£å†³ä¸Šè¿°é—®é¢˜çš„åŸºæœ¬æ€è·¯æ˜¯ï¼šå¦‚æžœæ‰€æœ‰å˜é‡çš„è§£éƒ½æ»¡è¶³æ­¤æœ€ä¼˜åŒ–é—®é¢˜çš„KKTæ¡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæœ€ä¼˜åŒ–é—®é¢˜çš„è§£å°±å¾—åˆ°äº†ï¼Œå› ä¸ºKKTæ¡ä»¶æ˜¯è¯¥æœ€ä¼˜åŒ–é—®é¢˜çš„å……è¦æ¡ä»¶ã€‚å¦åˆ™ï¼Œé€‰æ‹©ä¸¤ä¸ªå˜é‡ï¼Œå›ºå®šå…¶ä»–å˜é‡ï¼›é’ˆå¯¹è¿™ä¸¤ä¸ªå˜é‡æž„å»ºä¸€ä¸ªäºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œè¿™ä¸ªäºŒæ¬¡è§„åˆ’é—®é¢˜å…³äºŽè¿™ä¸¤ä¸ªå˜é‡çš„è§£åº”è¯¥æ›´æŽ¥è¿‘åŽŸå§‹äºŒæ¬¡è§„åˆ’é—®é¢˜çš„è§£ï¼Œå› ä¸ºè¿™ä¼šä½¿å¾—åŽŸå§‹é—®é¢˜çš„ç›®æ ‡å‡½æ•°å˜å¾—æ›´å°ã€‚é‡è¦çš„æ˜¯ï¼Œè¿™æ—¶å­é—®é¢˜å¯ä»¥é€šè¿‡è§£æžæ–¹æ³•æ±‚è§£ï¼Œè¿™æ ·å°±å¯ä»¥å¤§å¤§æé«˜æ•´ä¸ªç®—æ³•çš„è®¡ç®—é€Ÿåº¦ã€‚

ç”±äºŽ $\sum_{i=1}^N\alpha_iy_i=0$ï¼Œå‡å¦‚$\alpha_3,\alpha_4,...,\alpha_m$ å›ºå®šï¼Œé‚£ä¹ˆ$\alpha_1,\alpha_2$çš„å…³ç³»ä¹Ÿå°±ç¡®å®šäº†ï¼Œè¿™æ ·SMOç®—æ³•å°†ä¸€ä¸ªå¤æ‚çš„ä¼˜åŒ–ç®—æ³•è½¬åŒ–ä¸ºä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ä¸¤å˜é‡ä¼˜åŒ–é—®é¢˜ã€‚

æ•´ä¸ªSMOç®—æ³•åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šæ±‚è§£ä¸¤ä¸ªå˜é‡çš„äºŒæ¬¡è§„åˆ’çš„è§£æžæ–¹æ³•ã€é€‰æ‹©å˜é‡çš„å¯å‘å¼æ–¹æ³•ã€‚

### ä¸¤ä¸ªå˜é‡çš„äºŒæ¬¡è§„åˆ’çš„æ±‚è§£æ–¹æ³•

å‡è®¾æ‰€é€‰ä¸¤ä¸ªå˜é‡ä¸º$\alpha_1,\alpha_2$ï¼Œå…¶ä»–å˜é‡$\alpha_i,i=3,...,n$æ˜¯å›ºå®šçš„ï¼Œé‚£ä¹ˆSMOçš„æœ€ä¼˜åŒ–é—®é¢˜çš„å­é—®é¢˜å°±å¯ä»¥å†™ä¸ºï¼š
$$
\min_{\alpha_{1}, \alpha_{2}} \quad W\left(\alpha_{1}, \alpha_{2}\right)=\frac{1}{2} K_{11} \alpha_{1}^{2}+\frac{1}{2} K_{22} \alpha_{2}^{2}+y_{1} y_{2} K_{12} \alpha_{1} \alpha_{2} \\
\quad-\left(\alpha_{1}+\alpha_{2}\right)+y_{1} \alpha_{1} \sum_{i=3}^{N} y_{i} \alpha_{i} K_{i 1}+y_{2} \alpha_{2} \sum_{i=3}^{N} y_{i} \alpha_{i} K_{i 2} \\
\text { s.t. } \quad \alpha_{1} y_{1}+\alpha_{2} y_{2}=-\sum_{i=3}^{N} \alpha_{i} y_{i}=\varsigma \\
0 \leq \alpha_{i} \leq C, \quad i=1,2
$$
å…¶ä¸­ï¼Œ$K_{ij}=K(x_i,x_j)$ï¼Œ$\zeta$æ˜¯å¸¸æ•°ï¼Œä¸Šå¼çœç•¥äº†ä¸å«$\alpha_1,\alpha_2$çš„å¸¸æ•°é¡¹ã€‚

ä¸ºäº†æ±‚è§£ä¸Šé¢çš„ä¼˜åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ†æžçº¦æŸæ¡ä»¶ã€‚



![img](D:\.nutstore\1\æˆ‘çš„åšæžœäº‘\markdown_file\image\1042406-20161128221540099-1580490663.png)

æ ¹æ®ä¸Šé¢çš„çº¦æŸæ¡ä»¶$\alpha_1+\alpha_2=\varsigma$ï¼Œ$\alpha_i\leq C,i=1,2$å› ä¸º$y_1,y_2$åªèƒ½å–1æˆ–è€…-1ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æž„é€ ä¸Šå›¾ï¼Œ$\alpha_1,\alpha_2$åœ¨0-CèŒƒå›´çš„ç›’å­é‡Œé¢ï¼Œè€Œä¸”æ–œçŽ‡åªèƒ½æ˜¯1æˆ–è€…-1ï¼Œå·¦è¾¹çš„å›¾æ˜¯$y_1â‰ y_2$çš„æƒ…å½¢ï¼Œå¹¶ä¸”æˆ‘ä»¬è§„å®š$\alpha_1-\alpha_2=k$ï¼Œçº¢è‰²çš„é‚£æ¡çº¿ä»£è¡¨äº†$\alpha_1ï¼œ\alpha_2$ï¼Œå› æ­¤kå°äºŽ0ï¼Œå¹¶ä¸”æˆ‘ä»¬æ±‚å‡ºåœ¨ç›’å­è¾¹ç¼˜çš„åæ ‡ã€‚å¦å¤–ä¸€æ¡ç°è‰²çš„çº¿ä»£è¡¨äº†$\alpha_1ï¼ž\alpha_2$ï¼Œå› æ­¤kæ˜¯å¤§äºŽ0çš„ã€‚å³è¾¹çš„å›¾è¡¨ç¤ºçš„æ˜¯$y_1=y_2$çš„æƒ…å†µã€‚

ç”±äºŽ$\alpha_1,\alpha_2$çš„å…³ç³»è¢«é™åˆ¶åœ¨ç›’å­é‡Œçš„ä¸€æ¡çº¿æ®µä¸Šï¼Œæ‰€ä»¥ä¸¤å˜é‡çš„ä¼˜åŒ–é—®é¢˜å®žé™…ä¸Šä»…ä»…æ˜¯ä¸€ä¸ªå˜é‡çš„ä¼˜åŒ–é—®é¢˜ã€‚ä¸å¦¨æˆ‘ä»¬å‡è®¾æœ€ç»ˆæ˜¯$\alpha_2$çš„ä¼˜åŒ–é—®é¢˜ã€‚ç”±äºŽæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯å¯å‘å¼çš„è¿­ä»£æ³•ï¼Œå‡è®¾æˆ‘ä»¬ä¸Šä¸€è½®è¿­ä»£å¾—åˆ°çš„è§£æ˜¯$\alpha_1^{old},\alpha_2^{old}$ï¼Œå‡è®¾æ²¿ç€çº¦æŸæ–¹å‘$\alpha_2$æœªç»å‰ªè¾‘çš„è§£æ˜¯$\alpha_2^{new,unc}$æœ¬è½®è¿­ä»£å®ŒæˆåŽçš„è§£ä¸º$\alpha_1^{new},\alpha_2^{new}$ã€‚

ç”±äºŽ$\alpha_2^{new}$å¿…é¡»æ»¡è¶³ä¸Šå›¾ä¸­çš„çº¦æŸæ¡ä»¶ï¼Œå‡è®¾Lå’ŒHæ˜¯$\alpha_2^{new}$æ‰€åœ¨çš„çº¿æ®µçš„è¾¹ç•Œï¼Œæ‰€ä»¥å°±å¾—åˆ°äº†:
$$
L \leq \alpha_2^{new} \leq H
$$
åŽŸæœ¬$\alpha_2^{new}$çš„é™åˆ¶åªæ˜¯0â€”â€”Cè¿™ä¸ªåŒºé—´ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šé¢çš„å›¾ç¼©å°$\alpha_2^{new}$çš„å–å€¼åŒºé—´ï¼Œåªè§‚å¯Ÿçºµè½´ï¼Œå½±å“$\alpha_2^{new}$å–å€¼çš„åæ ‡åªæœ‰$(0,-k)$å’Œ$(C,C-k)$ï¼Œå‰è€…å¯ä»¥å’Œ0å¯¹æ¯”ï¼Œå–å¤§çš„é‚£ä¸ªä½œä¸ºLï¼ŒåŽè€…å¯ä»¥å’ŒCå¯¹æ¯”ï¼Œå–å°çš„ä½œä¸ºHã€‚å·²çŸ¥$k=(\alpha_1-\alpha_2)$å¸¦å…¥å°±å¯ä»¥å¾—åˆ°ç»“æžœã€‚
$$
L=\max \left(0, \alpha_{2}^{\text {old }}-\alpha_{1}^{\text {old }}\right) \quad H=\min \left(C, C+\alpha_{2}^{\text {old }}-\alpha_{1}^{\text {old }}\right)
$$
åŒç†å³è¾¹çš„å›¾å¯ä»¥å¾—åˆ°:
$$
L=\max \left(0, \alpha_{2}^{\text {old }}+\alpha_{1}^{\text {old }}-C\right) \quad H=\min \left(C, \alpha_{2}^{\text {old }}+\alpha_{1}^{\text {old }}\right)
$$
ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬é€šè¿‡æ±‚å¯¼å¾—åˆ°$\alpha_2^{new,unc}$ï¼Œæœ€ç»ˆçš„$\alpha_2^{new}$åº”è¯¥ä¸º:
$$
\alpha_{2}^{\text {new }}=\left\{\begin{array}{ll}
H & \alpha_{2}^{\text {new,unc }}>H \\
\alpha_{2}^{\text {new,unc }} & L \leq \alpha_{2}^{\text {new,unc }} \leq H \\
L & \alpha_{2}^{\text {new,unc }}<L
\end{array}\right.
$$
æˆ‘ä»¬å°†ç›®æ ‡å‡½æ•°å¯¹$\alpha_2$æ±‚åå¯¼å°±å¯ä»¥å¾—åˆ°$\alpha_2^{new,unc}$ã€‚

æˆ‘ä»¬å†æ•´ç†ä¸‹ç›®æ ‡å‡½æ•°ï¼Œ

ä¸ºäº†ç®€åŒ–å™è¿°ï¼Œè®°ï¼š
$$
g(x)=w^{*} \bullet \phi(x)+b=\sum_{i=1}^{N} \alpha_{i}^{*} y_{i} K\left(x, x_{i}\right)+b^{*}
$$
ä»¤:
$$
E_{i}=g\left(x_{i}\right)-y_{i}=\left(\sum_{j=1}^{N} \alpha_{j} y_{j} K\left(x_{j}, x_{i}\right)+b\right)-y_{i}, \quad i=1,2 \\
v_{i}=\sum_{j=3}^{N} \alpha_{j} y_{j} K\left(x_{i}, x_{j}\right)=g\left(x_{i}\right)-\sum_{j=1}^{2} \alpha_{j} y_{j} K\left(x_{i}, x_{j}\right)-b, \quad i=1,2
$$
å½“$i=1,2$æ—¶ï¼Œ$E_i$ä¸ºå‡½æ•°$g(x)$å¯¹è¾“å…¥$x_i$çš„é¢„æµ‹å€¼ä¸ŽçœŸå®žå€¼$y_i$çš„å·®ï¼Œç›®æ ‡å‡½æ•°å¯ä»¥å†™ä¸º:
$$
\begin{aligned}
W\left(\alpha_{1}, \alpha_{2}\right)=& \frac{1}{2} K_{11} \alpha_{1}^{2}+\frac{1}{2} K_{22} \alpha_{2}^{2}+y_{1} y_{2} K_{12} \alpha_{1} \alpha_{2} \\
&-\left(\alpha_{1}+\alpha_{2}\right)+y_{1} v_{1} \alpha_{1}+y_{2} v_{2} \alpha_{2}
\end{aligned}
$$
å› ä¸º$\alpha_1y_1=\varsigma-\alpha_2y_2, y_i^2=1$ï¼Œæ‰€ä»¥$\alpha_1$å¯ä»¥è¡¨ç¤ºä¸º:
$$
\alpha_{1}=\left(\varsigma-y_{2} \alpha_{2}\right) y_{1}
$$
å¸¦å…¥ï¼Œå¾—ï¼š
$$
\begin{array}{c}
W\left(\alpha_{2}\right)=\frac{1}{2} K_{11}\left[\left(\varsigma-y_{2} \alpha_{2}\right) y_{1}\right]^{2}+\frac{1}{2} K_{22} \alpha_{2}^{2}+y_{1} y_{2} K_{12}\left(\varsigma-y_{2} \alpha_{2}\right) y_{1} \alpha_{2} \\
-\left[\left(\varsigma-y_{2} \alpha_{2}\right) y_{1}+\alpha_{2}\right]+y_{1} v_{1}\left(\varsigma-y_{2} \alpha_{2}\right) y_{1}+y_{2} v_{2} \alpha_{2} \\
=\frac{1}{2} K_{11}\left(\varsigma-y_{2} \alpha_{2}\right)^{2}+\frac{1}{2} K_{22} \alpha_{2}^{2}+y_{2} K_{12}\left(\varsigma-y_{2} \alpha_{2}\right) \alpha_{2} \\
-\left(\varsigma-y_{2} \alpha_{2}\right) y_{1}-\alpha_{2}+v_{1}\left(\varsigma-y_{2} \alpha_{2}\right)+y_{2} v_{2} \alpha_{2}
\end{array}
$$
çŽ°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡æ±‚åå¯¼æ¥å¾—åˆ°$\alpha_2^{new,nuc}$
$$
\frac{\partial W}{\partial \alpha_{2}}=K_{11} \alpha_{2}+K_{22} \alpha_{2}-2 K_{12} \alpha_{2}-K_{11} \varsigma y_{2}+K_{12} \varsigma y_{2}+y_{1} y_{2}-1-v_{1} y_{2}+y_{2} v_{2}=0
$$
æ•´ç†åŽå¾—:
$$
\left(K_{11}+K_{22}-2 K_{12}\right) \alpha_{2}=y_{2}\left(y_{2}-y_{1}+\varsigma K_{11}-\varsigma K_{12}+v_{1}-v_{2}\right) \\
=y_{2}\left(y_{2}-y_{1}+\varsigma K_{11}-\varsigma K_{12}+\left(g\left(x_{1}\right)-\sum_{j=1}^{2} y_{j} \alpha_{j} K_{1 j}-b\right)-\left(g\left(x_{2}\right)-\sum_{j=1}^{2} y_{j} \alpha_{j} K_{2 j}-b\right)\right)
$$
å°†$\varsigma=\alpha_{1}^{\text {old }} y_{1}+\alpha_{2}^{\text {old }} y_{2}$å¸¦å…¥å¾—:
$$
\begin{array}{c}
\left(K_{11}+K_{22}-2 K_{12}\right) \alpha_{2}^{\text {new }, \text { unc }}=y_{2}\left(\left(K_{11}+K_{22}-2 K_{12}\right) \alpha_{2}^{\text {old }} y_{2}+y_{2}-y_{1}+g\left(x_{1}\right)-g\left(x_{2}\right)\right) \\
=\left(K_{11}+K_{22}-2 K_{12}\right) \alpha_{2}^{\text {old }}+y_{2}\left(E_{1}-E_{2}\right)
\end{array}
$$
æ•´ç†å¯å¾—:
$$
\alpha_{2}^{\text {new,unc }}=\alpha_{2}^{\text {old }}+\frac{y_{2}\left(E_{1}-E_{2}\right)}{\left.K_{11}+K_{22}-2 K_{12}\right)}
$$
å¾—åˆ°äº†$\alpha_2^{new}$åŽï¼Œæ ¹æ®çº¿æ€§å…³ç³»ï¼Œå¯ä»¥å¾—åˆ°$\alpha_1^{new}$

### å˜é‡é€‰æ‹©æ–¹æ³•

#### ç¬¬ä¸€ä¸ªå˜é‡çš„é€‰æ‹©:

SMOç®—æ³•ç§°é€‰æ‹©ç¬¬ä¸€ä¸ªå˜é‡ä¸ºå¤–å±‚å¾ªçŽ¯ï¼Œè¿™ä¸ªå˜é‡éœ€è¦é€‰æ‹©åœ¨è®­ç»ƒé›†ä¸­è¿åKKTæ¡ä»¶æœ€ä¸¥é‡çš„æ ·æœ¬ç‚¹ã€‚æ£€æŸ¥æ ·æœ¬ç‚¹æ˜¯å¦æ»¡è¶³$KKT$æ¡ä»¶ï¼š
$$
\begin{array}{c}
\alpha_{i}^{*}=0 \Rightarrow y_{i} g\left(x_{i}\right) \geq 1 (æ­£å¸¸åˆ†ç±») \\
0<\alpha_{i}^{*}<C \Rightarrow y_{i} g\left(x_{i}\right)=1(æ”¯æŒå‘é‡) \\
\alpha_{i}^{*}=C \Rightarrow y_{i} g\left(x_{i}\right) \leq 1(ä¸¤è¾¹ç•Œä¹‹é—´)
\end{array}
$$
ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬é¦–å…ˆé€‰æ‹©è¿å$0<\alpha_{i}^{*}<C \Rightarrow y_{i} g\left(x_{i}\right)=1$è¿™ä¸ªæ¡ä»¶çš„ç‚¹ã€‚å¦‚æžœè¿™äº›æ”¯æŒå‘é‡éƒ½æ»¡è¶³KKTæ¡ä»¶ï¼Œå†é€‰æ‹©è¿å$\alpha_{i}^{*}=0 \Rightarrow y_{i} g\left(x_{i}\right) \geq 1$å’Œ$\alpha_{i}^{*}=C \Rightarrow y_{i} g\left(x_{i}\right) \leq 1$çš„ç‚¹ã€‚

#### ç¬¬äºŒä¸ªå˜é‡çš„é€‰æ‹©

ã€€SMOç®—æ³•ç§°é€‰æ‹©ç¬¬äºŒä¸ªå˜é‡ä¸ºå†…å±‚å¾ªçŽ¯ï¼Œå‡è®¾æˆ‘ä»¬åœ¨å¤–å±‚å¾ªçŽ¯å·²ç»æ‰¾åˆ°äº†$\alpha_1$, ç¬¬äºŒä¸ªå˜é‡$\alpha_2$çš„é€‰æ‹©æ ‡å‡†æ˜¯å˜åŒ–è¶³å¤Ÿå¤§ï¼Œè€Œ$\alpha_2$ä¾èµ–äºŽ$|E_1-E_2|$ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡å°±å˜æˆäº†$|E_1-E_2|$æœ‰è¶³å¤Ÿå¤§çš„å˜åŒ–ã€‚ç”±äºŽ$\alpha_1$å®šäº†çš„æ—¶å€™,$E_1$ä¹Ÿç¡®å®šäº†ï¼Œæ‰€ä»¥è¦æƒ³$|E_1-E_2|$æœ€å¤§ï¼Œåªéœ€è¦åœ¨$E_1$ä¸ºæ­£æ—¶ï¼Œé€‰æ‹©æœ€å°çš„$E_i$ä½œä¸º$E_2$ï¼Œ åœ¨$E_1$ä¸ºè´Ÿæ—¶ï¼Œé€‰æ‹©æœ€å¤§çš„$E_i$ä½œä¸º$E_2$ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„$E_i$ä¿å­˜ä¸‹æ¥åŠ å¿«è¿­ä»£ã€‚

ã€€ã€€ã€€ã€€å¦‚æžœå†…å­˜å¾ªçŽ¯æ‰¾åˆ°çš„ç‚¹ä¸èƒ½è®©ç›®æ ‡å‡½æ•°æœ‰è¶³å¤Ÿçš„ä¸‹é™ï¼Œ å¯ä»¥é‡‡ç”¨éåŽ†æ”¯æŒå‘é‡ç‚¹æ¥åš$\alpha_2$,ç›´åˆ°ç›®æ ‡å‡½æ•°æœ‰è¶³å¤Ÿçš„ä¸‹é™ï¼Œ å¦‚æžœæ‰€æœ‰çš„æ”¯æŒå‘é‡åš$\alpha_2$éƒ½ä¸èƒ½è®©ç›®æ ‡å‡½æ•°æœ‰è¶³å¤Ÿçš„ä¸‹é™ï¼Œå¯ä»¥è·³å‡ºå¾ªçŽ¯ï¼Œé‡æ–°é€‰æ‹©$\alpha_1$ã€‚

å½“å®Œæˆä¸¤ä¸ªå˜é‡çš„ä¼˜åŒ–åŽï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°è®¡ç®—é˜ˆå€¼bã€‚å½“$0ï¼œ\alpha_1^{new}ï¼œC$ï¼Œç”±KKTæ¡ä»¶ï¼š
$$
y_{1}-\sum_{i=1}^{N} \alpha_{i} y_{i} K_{i 1}-b_{1}=0
$$
æ‰€ä»¥æ›´æ–°ä¹‹åŽçš„$b_1^{new}$å°±ç­‰äºŽ:
$$
b_{1}^{\text {new }}=y_{1}-\sum_{i=3}^{N} \alpha_{i} y_{i} K_{i 1}-\alpha_{1}^{\text {new }} y_{1} K_{11}-\alpha_{2}^{\text {new }} y_{2} K_{21}
$$
$E_1$ä¸ºï¼š
$$
E_{1}=g\left(x_{1}\right)-y_{1}=\sum_{i=3}^{N} \alpha_{i} y_{i} K_{i 1}+\alpha_{1}^{o l d} y_{1} K_{11}+\alpha_{2}^{o l d} y_{2} K_{21}+b^{o l d}-y_{1}
$$
å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ä¸¤ä¸ªå¼å­éƒ½æœ‰$y_{1}-\sum_{i=3}^{N} \alpha_{i} y_{i} K_{i 1}$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†$b_1^{new}$ç”¨$E_1$è¡¨ç¤º
$$
b_{1}^{\text {new }}=-E_{1}-y_{1} K_{11}\left(\alpha_{1}^{\text {new }}-\alpha_{1}^{\text {old }}\right)-y_{2} K_{21}\left(\alpha_{2}^{\text {new }}-\alpha_{2}^{\text {old }}\right)+b^{\text {old }}
$$
åŒç†ï¼š
$$
b_{2}^{\text {new }}=-E_{2}-y_{1} K_{12}\left(\alpha_{1}^{\text {new }}-\alpha_{1}^{\text {old }}\right)-y_{2} K_{22}\left(\alpha_{2}^{\text {new }}-\alpha_{2}^{\text {old }}\right)+b^{\text {old }}
$$
å¦‚æžœ$\alpha_1^{new},\alpha_2^{new}$æ»¡è¶³$0 ï¼œ \alpha_i^{new}ï¼œC,i=1,2$ï¼Œé‚£ä¹ˆï¼š
$$
b^{new}=b_1^{new}=b_2^{new}
$$


å¦åˆ™$b^{new}$ä¸º:
$$
b^{\text {new }}=\frac{b_{1}^{\text {new }}+b_{2}^{\text {new }}}{2}
$$
å¾—åˆ°$b^{new}$åŽï¼Œæˆ‘ä»¬æ›´æ–°$E_i$ä¸ºï¼š
$$
E_{i}=\sum_{S} y_{j} \alpha_{j} K\left(x_{i}, x_{j}\right)+b^{n e w}-y_{i}
$$
Sæ˜¯æ‰€æœ‰æ”¯æŒå‘é‡$x_j$çš„é›†åˆã€‚

#### SMOç®—æ³•æµç¨‹

è¾“å…¥:è¾“å…¥è®­ç»ƒé›†$T=\{ (x_1,y_1),...,(x_N,y_N)\}$ï¼Œ$x_i$æ˜¯nç»´çš„ç‰¹å¾å‘é‡ã€‚yæ˜¯1æˆ–è€…-1ï¼Œç²¾åº¦$\epsilon$ï¼Œè¾“å‡ºä¸ºè¿‘ä¼¼è§£$\hat{\alpha}$ã€‚

1. å–åˆå€¼$\alpha^0=0$, $k=0$
2. é€šè¿‡å‰é¢çš„å˜é‡é€‰æ‹©$\alpha_1^k$å’Œ$\alpha_2^k$ï¼Œå¹¶æ±‚$\alpha_2^{new,unc}$

$$
\alpha_{2}^{n e w, \text { unc }}=\alpha_{2}^{k}+\frac{y_{2}\left(E_{1}-E_{2}\right)}{\left.K_{11}+K_{22}-2 K_{12}\right)}
$$

3. ç„¶åŽæ±‚å‡º$\alpha_2^{k+1}$

$$
\alpha_{2}^{k+1}=\left\{\begin{array}{ll}
H & \alpha_{2}^{\text {new,unc }}>H \\
\alpha_{2}^{\text {new,unc }} & L \leq \alpha_{2}^{\text {new }, \text { unc }} \leq H \\
L & \alpha_{2}^{\text {new }, \text { unc }}<L
\end{array}\right.
$$

4. åˆ©ç”¨çº¿æ€§å…³ç³»æ±‚å‡º$\alpha_1^{k+1}$
5. æ±‚å‡º$b^{k+1}$å’Œ$E_i$
6. åœ¨ç²¾åº¦$\epsilon$èŒƒå›´å†…æ£€æŸ¥æ˜¯å¦æ»¡è¶³å¦‚ä¸‹çš„ç»ˆæ­¢æ¡ä»¶ï¼š

$$
\sum_{i=1}^{N} \alpha_{i} y_{i}=0 \\
0 \leq \alpha_{i} \leq C, i=1,2 \ldots N \\
\alpha_{i}^{k+1}=0 \Rightarrow y_{i} g\left(x_{i}\right) \geq 1 \\
0<\alpha_{i}^{k+1}<C \Rightarrow y_{i} g\left(x_{i}\right)=1 \\
\alpha_{i}^{k+1}=C \Rightarrow y_{i} g\left(x_{i}\right) \leq 1
$$

7. å¦‚æžœæ»¡è¶³åˆ™ç»“æŸï¼Œè¿”å›ž$\alpha^{k+1}$,å¦åˆ™è½¬åˆ°æ­¥éª¤2



## Referenceï¼š

https://www.bilibili.com/video/BV1Y7411P7nd?from=search&seid=6845846039550236819&spm_id_from=333.337.0.0

https://zhuanlan.zhihu.com/p/38296513

https://zhuanlan.zhihu.com/p/38163970

https://www.bilibili.com/video/BV1i4411G7Xv?p=7

